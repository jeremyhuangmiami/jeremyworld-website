<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Jeremy’s World — J-Games</title>
  <meta name="description" content="Play a big collection of free-to-play web games instantly in your browser on Jeremy’s World." />

  <!-- Inter font -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet" />

  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    :root{
      --bg1:#0b1220;
      --bg2:#0e1424;
      --gradA:#81e6d9;
      --gradB:#63b3ed;
    }
    body {
      font-family: 'Inter', sans-serif;
      background:
        radial-gradient(1200px 600px at 10% -10%, rgba(6,182,212,.12) 0%, transparent 60%),
        radial-gradient(900px 500px at 110% 110%, rgba(59,130,246,.12) 0%, transparent 60%),
        linear-gradient(140deg, var(--bg1), var(--bg2));
      background-attachment: fixed;
      color: #f9fafb;
    }
    .bg-grid {
      --c: rgba(255,255,255,0.04);
      background-image:
        linear-gradient(var(--c) 1px, transparent 1px),
        linear-gradient(90deg, var(--c) 1px, transparent 1px);
      background-size: 28px 28px;
      mask-image: radial-gradient(ellipse at 50% 50%, black 60%, transparent 100%);
      -webkit-mask-image: radial-gradient(ellipse at 50% 50%, black 60%, transparent 100%);
    }
    .text-gradient {
      background-image: linear-gradient(45deg, var(--gradA), var(--gradB));
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
    }
    .glass {
      background: linear-gradient(180deg, rgba(17,24,39,.55), rgba(17,24,39,.38));
      border: 1px solid rgba(99,179,237,.22);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      box-shadow: 0 8px 30px rgba(0,0,0,.35), 0 0 0 1px rgba(99,179,237,.18);
    }
    .tile {
      background: linear-gradient(180deg, rgba(31,41,55,.55), rgba(31,41,55,.4));
      border: 1px solid rgba(156,163,175,.25);
      transition: transform .25s ease, box-shadow .25s ease, border-color .25s ease;
    }
    .tile:hover {
      transform: translateY(-4px);
      border-color: rgba(99,179,237,.5);
      box-shadow: 0 12px 24px rgba(0,0,0,.4), 0 0 30px rgba(99,179,237,.35);
    }
    .focus-ring:focus-visible { outline: 2px solid #22D3EE; outline-offset: 2px; }
    .line-clamp-2 {
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;  
      overflow: hidden;
    }
  </style>
</head>
<body class="flex flex-col min-h-screen antialiased">
  <a href="#main" class="sr-only focus:not-sr-only focus-ring fixed top-3 left-3 z-[100] bg-gray-900/80 text-white px-3 py-2 rounded-md">Skip to content</a>
  <div aria-hidden="true" class="bg-grid fixed inset-0 pointer-events-none"></div>

  <!-- Header -->
  <header class="fixed top-0 inset-x-0 z-50">
    <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8">
      <div class="mt-3"></div>
      <nav class="glass rounded-2xl px-4 sm:px-6 py-3 flex items-center justify-between">
        <a href="index.html" class="inline-flex items-center gap-2 group focus-ring">
          <span class="text-2xl sm:text-3xl font-extrabold leading-none text-gradient">Jeremy’s World</span>
        </a>
        <button id="menuBtn" class="md:hidden inline-flex items-center justify-center h-10 w-10 rounded-md bg-white/5 hover:bg-white/10 transition focus-ring" aria-expanded="false" aria-controls="mobileNav" aria-label="Toggle menu">
          <svg class="h-6 w-6 text-gray-300" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" d="M4 6h16M4 12h16M4 18h16"/>
          </svg>
        </button>
        <ul class="hidden md:flex items-center gap-2">
          <li><a href="index.html" class="focus-ring px-3 py-2 rounded-md text-sm font-semibold text-gray-200 hover:text-white hover:bg-white/5 transition">Home</a></li>
          <li><a href="projects.html" class="focus-ring px-3 py-2 rounded-md text-sm font-semibold text-gray-200 hover:text-white hover:bg-white/5 transition">Projects</a></li>
          <li><a href="login.html" class="focus-ring px-3 py-2 rounded-md text-sm font-semibold text-gray-200 hover:text-white hover:bg-white/5 transition">Login/Register</a></li>
        </ul>
      </nav>
      <div id="mobileNav" class="hidden md:hidden mt-2">
        <div class="glass rounded-2xl px-4 py-3">
          <a href="index.html" class="block px-3 py-2 rounded-md text-sm font-semibold text-gray-200 hover:text-white hover:bg-white/5">Home</a>
          <a href="projects.html" class="block px-3 py-2 rounded-md text-sm font-semibold text-gray-200 hover:text-white hover:bg-white/5">Projects</a>
          <a href="login.html" class="block px-3 py-2 rounded-md text-sm font-semibold text-gray-200 hover:text-white hover:bg-white/5">Login/Register</a>
        </div>
      </div>
    </div>
  </header>

  <!-- Main -->
  <main id="main" class="flex-grow pt-32 pb-16">
    <section class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8">
      <h1 class="text-3xl sm:text-4xl font-extrabold text-gradient text-center">J-Games</h1>
      <p class="mt-3 text-center text-gray-300">Play instantly in your browser — no downloads, just click and play!</p>
      <div id="gameGrid" class="mt-8 grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4"></div>
      <div id="statusMsg" class="mt-6 text-center text-sm text-gray-400"></div>
    </section>
  </main>

  <!-- Fullscreen Modal -->
  <div id="gameModal" class="hidden fixed inset-0 bg-black/85 z-[9999]">
    <div class="relative w-full h-full">
      <button id="closeModalBtn" class="absolute top-4 right-4 text-white text-3xl leading-none z-10 focus-ring" aria-label="Close">&times;</button>
      <iframe id="gameIframe" src="" frameborder="0" class="w-full h-full"></iframe>
    </div>
  </div>

  <!-- Footer -->
  <footer class="mt-auto">
    <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8">
      <div class="glass rounded-2xl px-5 sm:px-8 py-8">
        <div class="flex flex-col sm:flex-row items-center justify-between gap-4">
          <p class="text-sm text-gray-300">&copy; 2025 Jeremy’s World. Crafted with passion.</p>
          <div class="flex items-center gap-6 text-sm">
            <a href="privacypolicy.html" class="text-gray-300 hover:text-white focus-ring rounded-md px-2 py-1">Privacy Policy</a>
            <a href="termsofservice.html" class="text-gray-300 hover:text-white focus-ring rounded-md px-2 py-1">Terms of Service</a>
          </div>
        </div>
      </div>
      <div class="h-6"></div>
    </div>
  </footer>

  <script>
    // Mobile nav toggle
    const btn = document.getElementById('menuBtn');
    const mobile = document.getElementById('mobileNav');
    if (btn && mobile) {
      btn.addEventListener('click', () => {
        const open = mobile.classList.contains('hidden') ? 'true' : 'false';
        btn.setAttribute('aria-expanded', open);
        mobile.classList.toggle('hidden');
      });
    }

    document.addEventListener("DOMContentLoaded", () => {
      const gameGrid = document.getElementById("gameGrid");
      const gameModal = document.getElementById("gameModal");
      const iframe = document.getElementById("gameIframe");
      const closeModalBtn = document.getElementById("closeModalBtn");
      const statusMsg = document.getElementById("statusMsg");

      let allGames = [];
      let currentIndex = 0;
      const PAGE_SIZE = 15;
      let loading = false;

      function openGameModal(game) {
        document.body.style.overflow = "hidden";
        gameModal.classList.remove("hidden");
        iframe.src = game.embed;
      }

      function closeGameModal() {
        document.body.style.overflow = "";
        gameModal.classList.add("hidden");
        iframe.src = "";
      }

      function createTile(game) {
        const tile = document.createElement("button");
        tile.type = "button";
        tile.className = "tile rounded-xl p-3 text-left cursor-pointer focus-ring w-full transition";
        tile.setAttribute("aria-label", `Play ${game.title}`);
        tile.innerHTML = `
          <div class="relative">
            <img src="${game.image}" alt="${game.title}" loading="lazy" class="w-full h-28 object-cover rounded-md" />
          </div>
          <h4 class="mt-2 text-white font-semibold text-sm line-clamp-2">${game.title}</h4>
        `;
        tile.addEventListener("click", () => openGameModal(game));
        return tile;
      }

      function renderNextBatch() {
        if (loading || currentIndex >= allGames.length) return;
        loading = true;
        const nextBatch = allGames.slice(currentIndex, currentIndex + PAGE_SIZE);
        const fragment = document.createDocumentFragment();
        nextBatch.forEach(game => fragment.appendChild(createTile(game)));
        gameGrid.appendChild(fragment);
        currentIndex += nextBatch.length;
        loading = false;
      }

      async function fetchGames() {
        statusMsg.textContent = "Loading games…";
        const corsProxy = 'https://corsproxy.io/?';
        const sources = [
          { url: "https://www.onlinegames.io/media/plugins/genGames/embed.json", normalizer: item => ({ title: item.title || "Untitled", image: item.image || "", embed: item.embed || item.url || "" }) },
          { url: "https://gamemonetize.com/feed.json", normalizer: item => ({ title: item.title || "Untitled", image: item.thumb || "", embed: item.iframe || item.url || "" }) }
        ];

        const tempGames = [];
        for (const src of sources) {
          try {
            const data = await fetch(corsProxy + encodeURIComponent(src.url)).then(r => r.json());
            const items = Array.isArray(data) ? data : Array.isArray(data?.games) ? data.games : [];
            tempGames.push(...items.map(src.normalizer).filter(g => g.embed));
          } catch (e) { console.error(`Failed to load ${src.url}`, e); }
        }

        const seen = new Set();
        allGames = tempGames.filter(g => {
          const key = g.embed.toLowerCase();
          if (seen.has(key)) return false;
          seen.add(key);
          return true;
        });

        statusMsg.textContent = `Loaded ${allGames.length} games.`;
        renderNextBatch(); // first 15 only
      }

      // Infinite scroll
      window.addEventListener("scroll", () => {
        if (window.innerHeight + window.scrollY >= document.body.offsetHeight - 300) {
          renderNextBatch();
        }
      });

      // Modal events
      closeModalBtn.addEventListener("click", closeGameModal);
      gameModal.addEventListener("click", e => { if (e.target === gameModal) closeGameModal(); });
      window.addEventListener("keydown", e => { if (e.key === "Escape") closeGameModal(); });

      fetchGames();
    });
  </script>
</body>
</html>
